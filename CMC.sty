%by 14级天大仁爱管理系金工唐绍东
%QQ 1096084877
% cmc.sty放入\texlive\texmf-local\tex\latex\local安装参考（http://wenda.latexstudio.net/article/1039）
\ProvidesPackage{CMC}[2019/04/02 v1.2 Non-standard LaTeX package]
%\documentclass[11pt,twoside,space]{article}
%\usepackage{CMC}  % .sty 向总定制


\RequirePackage[mtphrb]{mtpro2}
\RequirePackage[heading]{ctex}


%------------------------------- 大题 ----------------------------------%
\ctexset{section = {name = {,、\hspace*{-5mm}},number = \chinese{section},format = {\zihao{5}\raggedright}}}
\RequirePackage{titlesec}%titlesec宏包调整section与正文间距
\titlespacing*{\section}{0pt}{9pt}{4pt}
%------------------------------- 大题 ----------------------------------%

%=============================大题\dati{}{}==================================
%2017/10/29 大题大学生数学竞赛数学类原卷风格
\RequirePackage{array}
%\RequirePackage{CJKnumb} %中文小写数字\CJKnumber{\thedati}于20190402弃之
%\usepackage{calc}
\newcounter{dati} % 大题序号计数器
\newcommand{\datixuhao}{{\stepcounter{dati}\zhnumber{\thedati}、}\;}%输出大题序号,为"中文小写数字、"形式
\newcommand{\tbjifen}{
	\begin{tabular}{|c|m{3\ccwd}|}
	\hline
	\makebox[3\ccwd][s]{得分} & \rule{0pt}{6mm}\\\hline 
           阅卷人 & \rule{0pt}{6mm}\\\hline
\end{tabular}} % 大题前计分表格
\newcommand{\dati}[1]{\noindent\raisebox{-3.5ex}{
	\begin{minipage}[b]{9.2\ccwd}
		\tbjifen
	\end{minipage}}%输出大题前计分表,下沉3.5个X字符高度,可调整
	\begin{minipage}[t]
		{\textwidth-9.2\ccwd}\hspace*{2.55em}\datixuhao #1
	\end{minipage}}%输出大题序号,大题
%===============================大题\dati{题目}================================


%------------------------------ 选择题 ----------------------------------%
\RequirePackage{tasks}%选择题宏包，tasks环境
\settasks{counter-format={tsk[A].},
	      label-offset={0.4em},
          label-align=left,
          column-sep={2pt},
          item-indent={1pt},before-skip={-0.7em},after-skip={-0.7em}}
% 选择题示例 
%\begin{tasks}(4)
%	\task 
%	\task 
%	\task 
%	\task 
%\end{tasks}
%------------------------------ 选择题 ----------------------------------%



%%%--------------------------数学类---------------------------%%%
%=======================================================================
\RequirePackage{amsmath}
\everymath{\displaystyle} %全行间公式，不用一句一句的加\displaystyle
%\allowdisplaybreaks[4]%%%公式换页
\def\dif{\mathop{}\!\mathrm{d}}  %微分算子
\DeclareMathOperator{\rank}{rank} %矩阵的秩
\let\le=\leqslant
\let\ge=\geqslant
\RequirePackage{bm} %加粗
\RequirePackage{extarrows} %长等号
%\RequirePackage[fourier]{varint} %李清的可以修改积分符号的宏包


\RequirePackage{mathrsfs}
\RequirePackage{scalerel} %\scaleobj{1.5}{} 缩放公式大小

%%------------------------------------------------------------------------------------------------
%%---------------------------------- 定理\引理\定义样式设置 ------------------------------------%%
\RequirePackage{amsthm}
\renewcommand{\proofname}{\zhongsong{证明}}
\newenvironment{Proof}{\par\noindent{\zhongsong{证明.\,}}\small}{\hspace*{\fill}$\Box$\quad\par}
\newenvironment{Solution}{\par\noindent{\zhongsong{解.\,}}}{\hspace*{\fill}{$\Diamond$}\par}

%====================================================================%
%---------------------------------------solution环境-------------------------------------------------------------%
%%\RequirePackage{amsthm}
%\RequirePackage{thmtools}
%\declaretheoremstyle[
%spaceabove=-10pt, spacebelow=-10pt,
%headfont=\normalfont\bfseries,
%notefont=\mdseries, notebraces={(}{)},
%bodyfont=\normalfont,
%postheadspace=0.5em,
%headpunct={:},
%qed=$\blacktriangleleft$,
%numbered=no
%]{solstyle}
%\declaretheorem[style=solstyle,shaded={rulecolor=white,
%rulewidth=0.3pt, bgcolor={rgb}{1,1,1}},name=解]{solution}
%\newenvironment{Solution}{\par\noindent{\zhongsong{解.\,}}}{\hspace*{\fill}{$\Diamond$}\par}
\newenvironment{solution}{\par\noindent{\zhongsong{解.\,}}}{\hspace*{\fill}{$\Diamond$}\par}
%%----------------------------------------solution环境---------------------------------------------------------%
%====================================================================%
%-----------------------2017/9/1更新--------------------------




%-----------------------------------------------字体设置-----------------------------------------------------%

%%--------------------------嫌弃新罗马字体----------------------------
\newfontfamily\TNRBI{Times New Roman Bold Italic} %新罗马字体英文的粗斜体
\newcommand{\bfit}[1]{\text{\TNRBI #1}} %amsmath 
%%--------------------------------------------------------------------------------

%-------------------------------------中文字体设置------------------------------------------% 已弃方正字体
\RequirePackage{xeCJK}
\setCJKmainfont{Adobe Song Std L}%[BoldFont={Adobe Heiti Std R},ItalicFont={Adobe Kaiti Std Ri}]
\renewcommand{\heiti}{\CJKfontspec{Adobe Heiti Std R}}%adobe 黑体
\renewcommand{\fangsong}{\CJKfontspec{Adobe Fangsong Std R}}%adobe 仿宋
\renewcommand{\kaishu}{\CJKfontspec{Adobe Kaiti Std R}}%adobe 楷体
\def\xingkai{\CJKfontspec{STXingkai}}%华文行楷
\def\zhongsong{\CJKfontspec{STZhongsong}} %华文中宋
%===========================================================================


%------------------------------------------页眉页脚-%-装订线----------------------------------------%
\newlength{\Lzdx}\setlength{\Lzdx}{10.2cm}
\RequirePackage{tikz}
\usetikzlibrary{circuits} %circuit handle symbol
\RequirePackage{lastpage}
\RequirePackage{dashrule}%使用虚线宏包
%%------------------------------分数线，引导线的设置---------------------------------------------
\def\cfsxian#1{\hspace*{\fill}\raisebox{-1.1ex}{\tikz\draw[line width=1pt,dash pattern=on 1pt off 2.5pt on 1pt off 2.5pt] (0pt,0pt)--(5cm,0pt)node[right=-1mm]{(#1~分)\!\!};}\\}
\def\dfsxian#1{\hspace*{\fill}\raisebox{-1.1ex}{\tikz\draw[line width=1pt,dash pattern=on 1pt off 2.5pt on 1pt off 2.5pt] (0pt,0pt)--(3cm,0pt)node[right=-1mm]{(#1~分)\!\!};}\\}
\def\fsxian#1#2{\hspace*{\fill}\raisebox{-1.1ex}{\tikz\draw[line width=1pt,dash pattern=on 1pt off 2.5pt on 1pt off 2.5pt] (0pt,0pt)--(#1cm,0pt)node[right=-1mm]{(#2~分)\!\!};}\\}
\newcommand{\defen}[2][1cm]{\hspace*{\fill}\raisebox{-1.1ex}{\tikz\draw[line width=1pt,dash pattern=on 1pt off 2.5pt on 1pt off 2.5pt] (0pt,0pt)--(#1 ,0pt)node[right=-1mm]{(#2~分)};}\newline}
\newcommand{\score}[2][1cm]{\hspace*{\fill}\raisebox{-1.1ex}{\tikz\draw[line width=1pt,dash pattern=on 1pt off 2.5pt on 1pt off 2.5pt] (0pt,0pt)--(#1 ,0pt)node[right=-1mm]{(#2~分)};}\newline}
%\dfsxian{得分}\cfsxian{得分}\fsxian{长度(cm)}{得分} \defen[默认1cm]{得分}\score[默认1cm]{得分}
%%-----------------------------------------------------------------------------------------------
\RequirePackage{calc}%使用四则运算宏包%\usepackage{ulem}%画线的宏包
\RequirePackage{fancyhdr}%使用页眉页脚宏包
\pagestyle{fancy}
\fancyhf{}
\fancyfoot[CO]{\hspace*{1.5cm}第 \thepage 页 , 共 \pageref{LastPage} 页}
\fancyfoot[CE]{第 \thepage 页 , 共 \pageref{LastPage} 页\hspace*{1.5cm}}
\fancyhead[LO]{\hspace*{-2.2cm}\parbox{\paperheight}{\vspace*{-6.3mm}
\begin{tikzpicture}[line width=0.4pt,circuit]
\node (ym) [circle, draw,scale = 1.5] at (0pt,-15.5em) {};
\draw[dash pattern=on 6pt off 6pt on 6pt off 6pt] (0,-\Lzdx-16.5em) to
[circuit handle symbol={draw,shape=circle,pos=0.3},minimum size=5.5mm] (ym);
\node (yx) [circle, draw,scale = 1.5] at (0pt,0pt) {};
\draw[dash pattern=on 6pt off 6pt on 6pt off 6pt] (yx) node (a) [below=1em]{\rotatebox[origin=c]{90}{密封线\quad 答题时不要超过此线}} to
[circuit handle symbol={draw,shape=circle,pos=0.7},minimum size=5.5mm] (0,\Lzdx+1em) ;
\node  [scale=1] at (-1.1cm,-7.45em) {\rotatebox[origin=c]{90}{省市\underline{\makebox[25mm][c]{}}\songti 学校\underline{\makebox[32mm][c]{}}\songti~准考证号\underline{\makebox[34mm][c]{}} \songti 姓名\underline{\makebox[30mm][c]{}}考场号\underline{\makebox[16mm][c]{}}座位号\underline{\makebox[20mm][c]{}}}};
\end{tikzpicture}}}
\renewcommand{\headrulewidth}{0pt}
%-------------------------------------------------------------------------------------------------

%%%%%%%%%%%%%%%%%%%%%------设置文档属性-------%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage[colorlinks=true,bookmarksnumbered=true,linkcolor=black]{hyperref}
\AtBeginDocument{\hypersetup{pdftitle={\@title},
	pdfauthor={\@author},
	pdfsubject={中国大学生数学竞赛}, %pdf主题 %\@date
	pdfcreator={\@author},
	pdfproducer={\LaTeX},
	pdfkeywords={\@title,\@author, \@type, 大学生数学竞赛}
	}}
%%%%%%%%%%%%%%%%%%%%%------设置文档属性-------%%%%%%%%%%%%%%%%%%%%%%%%

%%--------------- 页面设置 ---------------%%
\RequirePackage{geometry}
\geometry{paperwidth=21.587cm,paperheight=27cm,top=2cm,bottom=2cm} %
  \oddsidemargin=0.5cm   %奇数页页边距
  \evensidemargin=0.5cm %偶数页页边距
\setlength{\marginparsep}{-0.8cm}



%%---------------------------------------------添加水印：机密-----------------------------------------------------------%%
\RequirePackage{graphicx} %插图
\RequirePackage{wrapfig}
\RequirePackage{eso-pic}
\newcommand{\watermark}[3]{\AddToShipoutPictureBG{%
\parbox[b][\paperheight]{\paperwidth}{%
\vfill%
\centering%
\tikz[remember picture, overlay]%
\node [rotate = #1, scale = #2] at (current page.center)%
{\textcolor{red!42}{#3}};  %gray!80!cyan!30
\vfill}}}
%\watermark{48}{11}{机密}  % 水印--第六届数学类
%\watermark{60}{6}{14-金融工程-白兔兔}
%%---------------------------------------------添加水印：机密----------------------------------------------------------%%


%%---------------------------------------------表格-----------------------------------------------------------%%
\usepackage{tabularx}
\newcolumntype{Y}{>{\centering\arraybackslash}X}

%=======================================================================
\RequirePackage{color,xcolor}%-颜色-%
%==============================================================================
%\RequirePackage{xcolor}
\newcommand{\blankcolor}[1]{\color{black}#1}
\DeclareOption{ans}{\providecommand{\blankcolor}[1]{{\color{black}#1}}}
\DeclareOption{shijuan}{\renewcommand{\blankcolor}[1]{{\color{white}#1}}
                                                 \renewenvironment{solution}{\setbox0\vbox\bgroup}{\egroup\unskip}
                                                \renewenvironment{Solution}{\setbox0\vbox\bgroup}{\egroup\unskip}
                                                \renewenvironment{Proof}{\setbox0\vbox\bgroup}{\egroup\unskip}
                                                \renewenvironment{proof}{\setbox0\vbox\bgroup}{\egroup\unskip} }
\ProcessOptions
\newcommand{\blank}[1]{\underline{\,\blankcolor{#1}\,}}
% ==================== \blank{答案} %2019/4/2 ==================== %

\RequirePackage{enumitem}

\def\examtime#1{\def\@examtime{#1}}
\def\type#1{\def\@type{#1}}
\def\maketitle{
{\centering
\begin{tabularx}{\textwidth}{@{}XYX}
\multicolumn{3}{c}{\zihao{-3}\heiti\@title}\\[1.5mm]
\multicolumn{3}{c}{\zihao{4}（ \@type, \@date）}\\[1.1em]
{\heiti\zihao{-4} 绝密$\bigstar$启用前} & (\@author) &\\[0.6em]
\multicolumn{3}{c}{\zihao{4}考试形式：\underline{~闭卷~}\hspace{2mm}考试时间：\underline{~~\@examtime~~}分钟~\hspace{2mm}满分：\underline{~~100~~}分}		
\end{tabularx}}}


\endinput
